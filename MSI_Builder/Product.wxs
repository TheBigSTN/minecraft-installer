<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">

  <!-- Use Product instead of Bundle for MSI -->
  <Product Id="*"
           Name="MyCSharpApp"
           Language="1033"
           Version="1.0.0.0"
           Manufacturer="Me"
           UpgradeCode="12345678-ABCD-1234-ABCD-1234567890AB">
    
    <!-- Define the directory structure -->
    <Package InstallerVersion="500" Compressed="yes" Comments="MyCSharpApp Installer"/>

    <Media Id="1" Cabinet="cab1.cab" EmbedCab="yes"/>

    <!-- Define the application installation -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="MyCSharpApp">
          <Component Id="AppFiles" Guid="{E18F8F3E-5FEC-4FF2-951C-5039C2552B79}">
            <File Id="MyCSharpAppFile" Source="..\MyCSharpApp\bin\Release\net9.0-windows\win-x64\MyCSharpApp.exe"/>
          </Component>
        </Directory>
      </Directory>
    </Directory>

    <Feature Id="ProductFeature" Title="MyCSharpApp" Level="1">
      <ComponentRef Id="AppFiles"/>
    </Feature>
  </Product>
</Wix>
